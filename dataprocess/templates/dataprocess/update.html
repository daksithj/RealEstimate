{% extends "dataprocess/base.html" %}
{% load crispy_forms_tags %}
{% block content %}
<div class = "row justify-content-center">
     <div class="col-md-6 " id="card-model">
    <div class="card ">
  <div class="card-body  h-100">
    <h1 class="display-4 text-center">Update pricing model</h1>
      <div class="row pt-4 justify-content-center">
    <h5 class="text-center"> Model last updated on:
    </h5>

      </div>
            <div class="row justify-content-center">
    <p class="text-center display-5">{{land.last_date}}
    </p>
      </div>

      <form class="col-md-12 mt-2 " id="model" name="model" method="post">
                {% csrf_token %}
                <p class="text-center lead">Only takes a few seconds to update</p>
                <button id="model-button" name="update_model"  onclick="hideform();" class="btn btn-info btn-block">Update model</button>


        </form>


      <h1 class="card-title text-center pt-4">Reset data repository</h1>
      <div class="row pt-4 justify-content-center">

          <div class="col md-10">
                 <p class="text-center lead">Involves scraping web data and pre processing which may take a long time (more than an hour)</p>
                <button id="database-button" name="reset_database"  class="btn btn-danger btn-block" data-toggle="modal"
                        data-target="#confirmation">Reset database</button>
              </div>


</div>
</div>
</div>
</div>
</div>


<div class="modal fade" id="confirmation" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Confirm data reset</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Process will take up to an hour. Services would be down in the meantime.
      </div>
      <div class="modal-footer">


        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <form  id="reset" name="reset" method="post">
              {% csrf_token %}
        <button  type="submit" class="btn btn-danger" onclick="hideform();" name="reset_data">Reset</button>
                </form>
      </div>
    </div>
  </div>
</div>



<div class = "row justify-content-center pt-4">
     <div class="col-md-6 "style = "display:none" id="card-done">
    <div class="card ">
  <h5 class="card-header">Processing</h5>
  <div class="card-body  h-100">
    <h5 class="card-title">Please wait till the update is completed</h5>
<div class="d-flex justify-content-center">
  <div class="spinner-border" role="status">
    <span class="sr-only">Loading...</span>
  </div>
</div>


  </div>

</div>
</div>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>

        function hideform(){

        document.getElementById('card-model').style.display ="none";
        document.getElementById('card-done').style.display ="block";
        $('#confirmation').modal( 'hide' );
    }

</script>
{% endblock content %}


